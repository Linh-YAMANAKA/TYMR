<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Valentine t·∫∑ng ng∆∞·ªùi th∆∞∆°ng</title>

<style>
  :root{
    --pink-1:#ffb6d9;
    --pink-2:#ff80bf;
    --accent:#ff2e88;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Roboto, sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
  body{
    overflow:hidden;
    background: linear-gradient(120deg, var(--pink-1), #ff95c9 30%, var(--pink-2) 60%, #ffd1ea 100%);
    background-size: 300% 300%;
    animation: bgShift 18s ease-in-out infinite;
    color:#2b0b1a;
  }
  @keyframes bgShift { 0%{ background-position:0% 50% } 50%{ background-position:100% 50% } 100%{ background-position:0% 50% } }

  .texture{ position:fixed; inset:0; z-index:0; pointer-events:none;
    background-image:
      radial-gradient(circle at 10% 20%, rgba(255,255,255,0.03), transparent 8%),
      radial-gradient(circle at 80% 30%, rgba(255,255,255,0.02), transparent 10%),
      radial-gradient(circle at 50% 70%, rgba(0,0,0,0.02), transparent 12%);
    mix-blend-mode: overlay;
    filter: saturate(1.02) contrast(1.01);
  }
  .vignette{ position:fixed; inset:0; z-index:1; pointer-events:none; background: radial-gradient(ellipse at center, rgba(255,255,255,0.02) 0%, rgba(0,0,0,0.28) 75%); mix-blend-mode:multiply; }
  .grain{ position:fixed; inset:0; z-index:2; pointer-events:none; opacity:0.06; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60"><filter id="n"><feTurbulence baseFrequency="0.9" numOctaves="1" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>'); background-repeat:repeat; mix-blend-mode:overlay; }

  .top-rain { position:fixed; inset:0; z-index:3; pointer-events:none; overflow:hidden; }
  .top-rain .drop {
    position:absolute;
    top:-6vh;
    will-change: transform, opacity;
    opacity:0;
    text-shadow:0 6px 16px rgba(0,0,0,0.12);
  }


    .particle {
  position: fixed;
  width: 12px;
  height: 12px;
  background: radial-gradient(circle, #fff, #ff4da6);
  border-radius: 50%;
  pointer-events: none;
  z-index: 9999;
}


    @keyframes explode {
    to {
        transform: translate(var(--x), var(--y)) scale(0.2);
        opacity: 0;
    }
    }


  .floating{ position:fixed; inset:0; z-index:4; pointer-events:none; overflow:hidden; }
  .float-item{ position:absolute; bottom:-8vh; will-change: transform, opacity; opacity:0; text-shadow:0 8px 28px rgba(0,0,0,0.18); }

  .stage{ position:relative; z-index:5; width:100vw; height:100vh; display:flex; align-items:center; justify-content:center; }

  .intro-heart{ position:fixed; left:50%; top:50%; transform:translate(-50%,-50%) scale(1); z-index:20; pointer-events:none; display:flex; align-items:center; justify-content:center; }
  .intro-heart .heart-large{ font-size:120vmin; transform-origin:center; transition: transform 2000ms cubic-bezier(.2,.9,.27,1), opacity 1000ms ease; filter: drop-shadow(0 60px 120px rgba(0,0,0,0.45)); }

  .center-wrap{ position:relative; width: min(1200px,92vw); height: min(880px,88vh); display:flex; align-items:center; justify-content:center; flex-direction:column; gap:18px; pointer-events:none; }

  .heart-wrap{ position:relative; width:100%; display:flex; align-items:center; justify-content:center; z-index:6; pointer-events:none; }
  .heart { font-size: clamp(120px, 22vmin, 420px); filter: drop-shadow(0 36px 80px rgba(0,0,0,0.35)); transform-origin:center; transition: transform 600ms cubic-bezier(.2,.9,.27,1), opacity 400ms; animation: heartBeat 1.1s infinite; }
  @keyframes heartBeat{ 0%{ transform:scale(1) rotate(-4deg) } 28%{ transform:scale(1.06) rotate(-2deg) } 46%{ transform:scale(0.98) rotate(2deg) } 100%{ transform:scale(1) rotate(-4deg) } }

  .heart-glow{ position:absolute; width:46vmin; height:46vmin; border-radius:50%; background: radial-gradient(circle at 50% 40%, rgba(255,102,150,0.35), rgba(255,102,150,0.12) 25%, rgba(255,102,150,0.02) 60%); filter: blur(36px); z-index:5; transform: translateY(6vmin); pointer-events:none; }

  .message-box { width:100%; max-width:880px; margin-top:12px; background: linear-gradient(180deg, rgba(255,255,255,0.94), rgba(255,255,255,0.90)); border-radius:12px; padding:16px 20px; box-shadow:0 18px 60px rgba(11,9,12,0.12); text-align:center; pointer-events:auto; z-index:6; min-height: 84px; }
  .message-text { font-size: clamp(16px, 2vw, 20px); color:#3b0b1a; line-height:1.35; font-weight:700; letter-spacing:0.2px; white-space: pre-wrap; }
  .caret { display:inline-block; width:2px; height:1.05em; background:var(--accent); margin-left:6px; vertical-align:middle; animation:blink 1s steps(2,end) infinite; }
  @keyframes blink{ 50%{ opacity:0 } }

  .fade-out{ opacity:0; transform: translateY(-8px) scale(.995); transition: opacity .9s ease, transform .9s ease; }

  .particle{ position:fixed; z-index:21; pointer-events:none; will-change: transform, opacity; text-shadow:0 6px 16px rgba(0,0,0,0.22); }

  .controls { position: fixed; right:20px; top:18px; z-index:30; display:flex; gap:10px; }
  .btn { pointer-events:auto; background: rgba(255,255,255,0.94); border-radius:999px; padding:8px 12px; font-weight:700; color:#3b0b1a; border:0; box-shadow:0 10px 28px rgba(0,0,0,0.12); cursor:pointer; }

  .final-card { position: fixed; inset:0; z-index:28; display:flex; align-items:center; justify-content:center; pointer-events:none; opacity:0; transition:opacity .5s ease; }
  .final-card.show{ opacity:1; pointer-events:auto; }
  .final-inner { background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.94)); padding:22px 28px; border-radius:12px; box-shadow:0 30px 90px rgba(0,0,0,0.32); text-align:center; }

  @media (max-width:900px){
    .message-box{ padding:12px 14px; min-height:70px; }
    .heart{ font-size: clamp(92px, 38vmin, 260px); }
    .heart-glow{ width:68vmin; height:68vmin; transform: translateY(14vmin); }
  }
</style>
</head>
<body>

  <div class="texture" aria-hidden="true"></div>
  <div class="vignette" aria-hidden="true"></div>
  <div class="grain" aria-hidden="true"></div>

  <div class="top-rain" id="topRain"></div>

  <div class="floating" id="floating"></div>

  <div class="intro-heart" id="introHeart" aria-hidden="true">
    <div class="heart-large" id="introHeartEmoji">‚ù§Ô∏è</div>
  </div>

  <main class="stage" role="main" aria-label="Valentine stage">
    <div class="center-wrap">

      <div class="heart-wrap" aria-hidden="true">
        <div class="heart-glow" id="heartGlow" aria-hidden="true"></div>
        <div class="heart" id="bigHeart" aria-hidden="true">‚ù§Ô∏è</div>
      </div>

      <div class="message-box" id="messageBox" role="region" aria-live="polite">
        <div class="message-text" id="messageText"></div>
        <div class="caret" id="caret" aria-hidden="true"></div>
      </div>

    </div>
  </main>

  <div class="controls" aria-hidden="true">
    <button class="btn" id="replayBtn">Xem l·∫°i</button>
  </div>

  <div class="final-card" id="finalCard" aria-hidden="true">
    <div class="final-inner">
      <div style="font-size:1.35rem;font-weight:800;margin-bottom:8px;">Happy Valentine's Day üíù</div>
      <div id="finalMessageText" style="color:#6b2b45;margin-bottom:12px;"></div>
      <div><button class="btn" id="finalClose">ƒê√≥ng</button></div>
    </div>
  </div>

<script>
const messages = [
  "üíå H√¥m nay 14/2, ƒë·ªìng th·ªùi c≈©ng ƒë√£ cu·ªëi nƒÉm r·ªìi! üéÄ",
  "üå∏ Mong r·∫±ng An s·∫Ω lu√¥n d·ªÖ th∆∞∆°ng, ƒë√°ng y√™u, vui v·∫ª v√† n·ªü n·ª• c∆∞·ªùi th·∫≠t t∆∞∆°i nh√©! üòäüíï",
  "üåπ Ch√∫c ng∆∞·ªùi ƒë·∫πp m·ªôt Valentine th·∫≠t ·∫•m √°p v√† h·∫°nh ph√∫c! üíñ‚ú®"
];

const finalDisplay = "üíù Happy Valentine's Day ‚Äî T·ªõ th∆∞∆°ng c·∫≠u! üíû";


const introHeart = document.getElementById('introHeart');
const introHeartEmoji = document.getElementById('introHeartEmoji');
const topRain = document.getElementById('topRain');
const floating = document.getElementById('floating');
const bigHeart = document.getElementById('bigHeart');
const heartGlow = document.getElementById('heartGlow');
const messageText = document.getElementById('messageText');
const caret = document.getElementById('caret');
const replayBtn = document.getElementById('replayBtn');
const finalCard = document.getElementById('finalCard');
const finalMessageText = document.getElementById('finalMessageText');
const finalClose = document.getElementById('finalClose');

function delay(ms){ return new Promise(res=>setTimeout(res, ms)); }

let topInterval = null;
function startTopRain(spawnInterval = 320) {
  topInterval = setInterval(()=> spawnTopDrop(), spawnInterval);
}
function stopTopRain(){ if (topInterval) clearInterval(topInterval); topInterval = null; }

function spawnTopDrop() {
  const el = document.createElement('div');
  el.className = 'drop';
  const pool = ['üíó','üåπ','üíû','üíï'];
  el.textContent = pool[Math.floor(Math.random()*pool.length)];
  const left = Math.random()*100;
  el.style.left = `${left}vw`;
  const size = 8 + Math.random()*18; 
  el.style.fontSize = `${size}px`;
  const duration = 16000 + Math.random()*32000; 
  const driftX = (Math.random()*40 - 20); 
  el.style.transition = `transform ${duration}ms linear, opacity ${duration}ms linear`;
  topRain.appendChild(el);
  requestAnimationFrame(()=>{
    el.style.transform = `translate(${driftX}px, 120vh) rotate(${(Math.random()*360 - 180)}deg) scale(${0.9 + Math.random()*0.6})`;
    el.style.opacity = '0';
  });
  setTimeout(()=> { try{ el.remove(); }catch(e){} }, duration + 120);
}

let floatIntervalId = null;
function startFloating(spawnInterval = 140) {
  floatIntervalId = setInterval(()=> spawnFloatItem(), spawnInterval);
}
function stopFloating(){ if (floatIntervalId) clearInterval(floatIntervalId); floatIntervalId = null; }

function spawnFloatItem() {
  const el = document.createElement('div');
  el.className = 'float-item';
  const pool = ['üíó','üíû','üíï','üåπ','üíì','üíñ','üíò'];
  el.textContent = pool[Math.floor(Math.random()*pool.length)];
  el.style.left = `${Math.random()*100}vw`;
  el.style.fontSize = `${10 + Math.random()*36}px`;
  const dur = 12000 + Math.random()*38000; 
  const dx = (Math.random()*48 - 24);
  el.style.transition = `transform ${dur}ms linear, opacity ${dur}ms linear`;
  floating.appendChild(el);
  requestAnimationFrame(()=> {
    el.style.transform = `translate(${dx}px, -140vh) rotate(${(Math.random()*360 - 180)}deg) scale(${0.9 + Math.random()*1.2})`;
    el.style.opacity = 0;
  });
  setTimeout(()=> { try{ el.remove(); } catch(e){} }, dur + 120);
}

function typeText(targetEl, text, opts = {}) {
  const speed = opts.speed || 36;
  const variance = opts.variance || 14;
  caret.style.display = 'inline-block';
  targetEl.textContent = '';
  let i = 0;
  return new Promise((resolve) => {
    function step(){
      if (i < text.length){
        targetEl.textContent += text.charAt(i++);
        const rand = Math.random();
        let wait = speed + (Math.random() * variance - variance/2);
        if (rand < 0.06) wait += 80;
        setTimeout(step, Math.max(12, Math.floor(wait)));
      } else {
        setTimeout(()=> { caret.style.display = 'none'; resolve(); }, 380);
      }
    }
    step();
  });
}

function fadeOutText(el, ms = 900) {
  return new Promise((resolve) => {
    el.style.transition = `opacity ${ms}ms ease, transform ${ms}ms ease`;
    el.style.opacity = '1';
    requestAnimationFrame(()=> {
      el.style.opacity = '0';
      el.style.transform = 'translateY(-8px) scale(.995)';
    });
    setTimeout(()=> {
      el.style.opacity = '1';
      el.style.transform = 'translateY(0) scale(1)';
      resolve();
    }, ms + 40);
  });
}

function createParticle(cx, cy, char = 'üíñ'){
  const p = document.createElement('div');
  p.className = 'particle';
  p.textContent = char;
  const size = 10 + Math.random()*36;
  p.style.fontSize = size + 'px';
  p.style.left = (cx - size/2) + 'px';
  p.style.top = (cy - size/2) + 'px';
  document.body.appendChild(p);
  const angle = Math.random()*Math.PI*2;
  const dist = (120 + Math.random()*420)*(0.9 + Math.random()*0.7);
  const tx = Math.cos(angle)*dist;
  const ty = Math.sin(angle)*dist;
  const rotate = (Math.random()*720 - 360);
  const dur = 700 + Math.random()*1100;
  requestAnimationFrame(()=> {
    p.style.transition = `transform ${dur}ms cubic-bezier(.2,.9,.27,1), opacity ${dur}ms linear`;
    p.style.transform = `translate(${tx}px, ${ty}px) rotate(${rotate}deg) scale(${0.8 + Math.random()*1.2})`;
    p.style.opacity = '0';
  });
  setTimeout(()=> { try{ p.remove(); }catch(e){} }, dur + 60);
}

async function particleBurstFromHeart(count = 150) {

  const heart = document.getElementById('bigHeart');
  const rect = heart.getBoundingClientRect();

  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;

  for (let i = 0; i < count; i++) {

    const particle = document.createElement('div');
    particle.className = 'particle';

    const angle = Math.random() * Math.PI * 2;
    const distance = 150 + Math.random() * 180;

    const x = Math.cos(angle) * distance;
    const y = Math.sin(angle) * distance;

    particle.style.left = centerX + 'px';
    particle.style.top = centerY + 'px';

    particle.animate([
      { transform: 'translate(0,0) scale(1)', opacity: 1 },
      { transform: `translate(${x}px, ${y}px) scale(0.3)`, opacity: 0 }
    ], {
      duration: 1200,
      easing: 'ease-out',
      fill: 'forwards'
    });

    document.body.appendChild(particle);

    setTimeout(() => {
      particle.remove();
    }, 1200);
  }
}

async function runFullSequence(){
  introHeart.style.display = 'flex';
  introHeartEmoji.style.transform = 'scale(1)';
  requestAnimationFrame(()=> {
    introHeartEmoji.style.transition = 'transform 2000ms cubic-bezier(.2,.9,.27,1), opacity 1000ms ease';
    introHeartEmoji.style.transform = 'scale(0.18)';
  });

  startTopRain(320);
  startFloating(140);

  await delay(2000);
  introHeartEmoji.style.opacity = '0';
  await delay(1000);
  introHeart.style.display = 'none';
  await runMessagesSequence();
}

async function runMessagesSequence(){
  await typeText(messageText, messages[0], { speed:34, variance:14 });
  await delay(1200);
  await fadeOutText(messageText, 900);
  messageText.textContent = '';
  await typeText(messageText, messages[1], { speed:36, variance:16 });
  await delay(1200);
  await fadeOutText(messageText, 900);
  messageText.textContent = '';
  bigHeart.style.transition = 'transform 900ms cubic-bezier(.2,.9,.27,1)';
  bigHeart.style.transform = 'scale(1.12) rotate(-1deg)';
  heartGlow.style.transition = 'transform 900ms ease, opacity 900ms ease';
  heartGlow.style.transform = 'translateY(4vmin) scale(1.05)';
  heartGlow.style.opacity = '1';

  await delay(300);
await typeText(messageText, messages[2], { speed:36, variance:12 });
await delay(300);
bigHeart.style.transition = 'transform 600ms cubic-bezier(.2,.9,.27,1)';
bigHeart.style.transform = 'scale(1.18) rotate(0deg)';

await delay(400);
await particleBurstFromHeart(120);
await delay(800);

showFinalCard();

}
function showFinalCard(){
  finalMessageText.textContent = finalDisplay;
  finalCard.classList.add('show');
  finalCard.setAttribute('aria-hidden','false');
  stopTopRain();
  stopFloating();
}

replayBtn.addEventListener('click', ()=> location.reload());
finalClose.addEventListener('click', ()=> {
  finalCard.classList.remove('show'); finalCard.setAttribute('aria-hidden','true');
});

window.addEventListener('load', ()=> {
  bigHeart.style.opacity = '1';
  heartGlow.style.opacity = '1';
  runFullSequence().catch(()=>{});
});

window.addEventListener('beforeunload', ()=> { stopTopRain(); stopFloating(); });
</script>

</body>

</html> 
